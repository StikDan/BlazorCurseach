@page "/profile"
@using BlazorCurseach.Models
@using BlazorCurseach.Services
@inject AuthService authService

@if (Client != null)
{
    <h2>Welcome @Client.login!</h2>

    <button class="btn btn-success" id="btn-log-out" type="submit" @onclick="() => LogOut()">
        Log Out
    </button>
}
else
{
    <h2>Loading profile...</h2>
}

@code {
    private Client? Client { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if(firstRender)
            Client = await authService.LoadDataAsync();
            StateHasChanged();
    }

    protected void LogOut()
    {
        authService.LogOut();
    }
}