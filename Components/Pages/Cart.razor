@page "/cart"
@using BlazorCurseach.Services
@inject OrderState orderState
@inject AuthService authService
@inject NavigationService navigationService
  
<div class="cart-container">
  <h2>Your Cart:</h2>

    @if(isSessionEmpty)
    {
        <p>Please <a href="/login">Login</a> or <a href="/join">Sign up</a> to get access to CurseMart cart.</p>
    }
    else
    {
        @if (orderState.cartItems != null && orderState.cartItems.Any())
        {
        <ul>
            @foreach (var item in orderState.cartItems)
            {
                <li>
                    <strong>@item.nameItem</strong> â€“ @item.price g
                </li>
            }
        </ul>
        }
        else
        {
            <p>Your cart is empty.</p>
        }
    }
</div>

@code {
    protected bool isSessionEmpty = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if(firstRender)
            isSessionEmpty = await authService.IsStorageEmptyAsync();
            await orderState.IsCartLoadedAsync();
            StateHasChanged();
    }
}